2025-08-08 09:30:13,217 - ERROR - ❌ 查找员工时发生未知错误: 'WeChatWorkService' object has no attribute 'get_access_token'
2025-08-08 09:30:13,217 - ERROR - 处理过程中发生未知错误: 企业微信API错误 [-1]: 查找员工失败: 'WeChatWorkService' object has no attribute 'get_access_token'
Traceback (most recent call last):
  File "/Users/ljp/Desktop/python/离职年假计算/src/services/wechat_service.py", line 146, in find_employee_by_name
    access_token = self.get_access_token()
                   ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'WeChatWorkService' object has no attribute 'get_access_token'. Did you mean: '_get_access_token'?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ljp/Desktop/python/离职年假计算/src/business/controller.py", line 73, in process_leave_calculation
    employee = self.wechat_service.find_employee_by_name(employee_name)
  File "/Users/ljp/Desktop/python/离职年假计算/src/services/wechat_service.py", line 200, in find_employee_by_name
    raise WeChatAPIError(-1, f"查找员工失败: {str(e)}")
services.wechat_service.WeChatAPIError: 企业微信API错误 [-1]: 查找员工失败: 'WeChatWorkService' object has no attribute 'get_access_token'
2025-08-08 09:30:13,308 - ERROR - 计算失败: 处理过程中发生未知错误: 企业微信API错误 [-1]: 查找员工失败: 'WeChatWorkService' object has no attribute 'get_access_token'
2025-08-08 09:30:51,378 - ERROR - ❌ 获取access_token时发生未知错误: 'WeChatWorkService' object has no attribute '_is_token_valid'
2025-08-08 09:30:51,378 - ERROR - ❌ 查找员工时发生未知错误: 企业微信API错误 [-1]: 获取access_token失败: 'WeChatWorkService' object has no attribute '_is_token_valid'
2025-08-08 09:30:51,378 - ERROR - 处理过程中发生未知错误: 企业微信API错误 [-1]: 查找员工失败: 企业微信API错误 [-1]: 获取access_token失败: 'WeChatWorkService' object has no attribute '_is_token_valid'
Traceback (most recent call last):
  File "/Users/ljp/Desktop/python/离职年假计算/src/services/wechat_service.py", line 92, in _get_access_token
    if self._is_token_valid():
       ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'WeChatWorkService' object has no attribute '_is_token_valid'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ljp/Desktop/python/离职年假计算/src/services/wechat_service.py", line 146, in find_employee_by_name
    access_token = self._get_access_token()
  File "/Users/ljp/Desktop/python/离职年假计算/src/services/wechat_service.py", line 127, in _get_access_token
    raise WeChatAPIError(-1, f"获取access_token失败: {str(e)}")
services.wechat_service.WeChatAPIError: 企业微信API错误 [-1]: 获取access_token失败: 'WeChatWorkService' object has no attribute '_is_token_valid'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ljp/Desktop/python/离职年假计算/src/business/controller.py", line 73, in process_leave_calculation
    employee = self.wechat_service.find_employee_by_name(employee_name)
  File "/Users/ljp/Desktop/python/离职年假计算/src/services/wechat_service.py", line 200, in find_employee_by_name
    raise WeChatAPIError(-1, f"查找员工失败: {str(e)}")
services.wechat_service.WeChatAPIError: 企业微信API错误 [-1]: 查找员工失败: 企业微信API错误 [-1]: 获取access_token失败: 'WeChatWorkService' object has no attribute '_is_token_valid'
2025-08-08 09:30:51,418 - ERROR - 计算失败: 处理过程中发生未知错误: 企业微信API错误 [-1]: 查找员工失败: 企业微信API错误 [-1]: 获取access_token失败: 'WeChatWorkService' object has no attribute '_is_token_valid'
2025-08-08 09:32:07,058 - ERROR - ❌ 获取年假余额失败:
2025-08-08 09:32:07,058 - ERROR -    - 异常类型: AttributeError
2025-08-08 09:32:07,058 - ERROR -    - 异常信息: 'WeChatWorkService' object has no attribute 'get_access_token'
2025-08-08 09:32:07,058 - ERROR -    - 员工姓名: 刘泽栋
2025-08-08 09:32:07,100 - ERROR - 计算失败: 获取假期余额失败: 解析假期余额数据失败: 'WeChatWorkService' object has no attribute 'get_access_token'
2025-08-08 09:33:56,034 - ERROR - ❌ 未找到员工: 留狗洞
2025-08-08 09:33:56,098 - ERROR - 计算失败: 未找到员工 '留狗洞'，请检查姓名是否正确
