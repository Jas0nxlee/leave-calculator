# 离职员工剩余年假计算程序 - 需求规格说明书

## 1. 项目概述

### 1.1 项目目标
开发一个基于Python的离职员工剩余年假计算程序，通过GUI界面输入员工信息，自动调用企业微信API获取假期数据，并计算员工离职时的剩余年假天数。

### 1.2 核心功能
- 提供友好的GUI界面进行数据输入和结果展示
- 集成企业微信API获取员工假期余额信息
- 实现基于离职日期的年假比例计算算法

## 2. 功能需求

### 2.1 用户界面需求
- **输入字段**:
  - 员工姓名（文本输入框）
  - 离职日期（日期选择器，格式：YYYY-MM-DD）
- **输出字段**:
  - 剩余年假天数（只读显示框，保留2位小数）
- **操作按钮**:
  - 计算按钮：触发年假计算流程
  - 清空按钮：重置所有输入字段
  - 退出按钮：关闭程序

### 2.2 企业微信API集成需求
- **API配置**:
  - 从.env文件读取企业微信API配置信息
  - 包含：企业ID、应用Secret、Access Token等
- **数据获取**:
  - 通过员工姓名查询员工ID
  - 获取"审批"应用中"假期余额"数据
  - 提取"2025年年假"的"已用时长"和"实际剩余时长"

### 2.3 年假计算算法需求
- **理论时长计算**: 已用时长 + 实际剩余时长
- **时间比例计算**: (当年1月1日至离职日期天数) / 当年总天数
- **剩余年假计算**: 理论时长 × 时间比例 - 已用时长

## 3. 技术需求

### 3.1 开发环境
- Python 3.8+
- GUI框架：tkinter（内置）或PyQt5/6
- HTTP请求库：requests
- 环境配置：python-dotenv
- 日期处理：datetime

### 3.2 API接口规范
- 企业微信API v2.0
- 支持OAuth2.0认证
- JSON数据格式交换
- 错误处理和重试机制

### 3.3 数据格式
- 日期格式：ISO 8601 (YYYY-MM-DD)
- 时长单位：小时（支持小数）
- 计算精度：保留2位小数

## 4. 非功能需求

### 4.1 性能要求
- API响应时间 < 5秒
- 界面响应时间 < 1秒
- 支持并发查询（如需要）

### 4.2 可用性要求
- 直观的用户界面设计
- 清晰的错误提示信息
- 操作流程简单明了

### 4.3 安全要求
- API密钥安全存储（.env文件）
- 输入数据验证和清理
- 错误信息不暴露敏感数据

## 5. 约束条件

### 5.1 技术约束
- 必须使用Python开发
- 依赖企业微信API的可用性
- 需要网络连接进行API调用

### 5.2 业务约束
- 仅计算2025年年假数据
- 按自然年计算（1月1日-12月31日）
- 离职日期不能超过当前日期

## 6. 验收标准

### 6.1 功能验收
- [ ] GUI界面正常显示和交互
- [ ] 能够成功调用企业微信API
- [ ] 年假计算结果准确无误
- [ ] 错误处理机制完善

### 6.2 质量验收
- [ ] 代码覆盖率 > 80%
- [ ] 无严重安全漏洞
- [ ] 用户体验流畅
- [ ] 文档完整清晰