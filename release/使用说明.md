# 离职年假计算器 - 使用说明

## 🎯 软件介绍

离职年假计算器是一款专业的企业人力资源工具，用于精确计算离职员工的剩余年假天数。通过企业微信API获取员工信息，自动计算年假余额，提高HR工作效率。

## 🚀 快速开始

### 1. 运行程序
- **macOS用户**: 双击 `离职年假计算器.app` 
- **其他系统**: 双击 `离职年假计算器` 可执行文件

### 2. 首次配置
程序首次运行时会自动创建 `.env` 配置文件，请按以下步骤配置：

1. 找到程序目录下的 `.env` 文件
2. 用文本编辑器打开
3. 填入您的企业微信配置信息：

```env
# 企业微信配置
CORP_ID=您的企业ID
CORP_SECRET=您的应用Secret

# API配置
BASE_URL=https://qyapi.weixin.qq.com
```

### 3. 获取企业微信配置

#### 企业ID (CORP_ID)
1. 登录企业微信管理后台
2. 进入"我的企业" → "企业信息"
3. 复制"企业ID"

#### 应用Secret (CORP_SECRET)
1. 进入"应用管理"
2. 创建或选择一个应用
3. 复制应用的"Secret"

## 💻 使用方法

### 主界面操作
1. **员工姓名**: 输入要查询的员工姓名
2. **离职日期**: 选择或输入离职日期
3. **计算年假**: 点击按钮开始计算
4. **查看结果**: 在结果区域查看剩余年假天数

### 功能特点
- ✅ 自动获取员工入职信息
- ✅ 精确计算年假余额
- ✅ 支持不同年假政策
- ✅ 详细的计算过程显示
- ✅ 错误提示和处理

## 🔧 故障排除

### 常见问题

#### 1. 程序无法启动
- 确保系统满足最低要求
- 检查是否有杀毒软件拦截
- 尝试以管理员权限运行

#### 2. 企业微信连接失败
- 检查网络连接
- 确认企业微信配置正确
- 验证企业ID和Secret是否有效

#### 3. 找不到员工信息
- 确认员工姓名拼写正确
- 检查员工是否在企业微信通讯录中
- 确认应用权限包含通讯录访问

#### 4. 计算结果异常
- 检查员工入职日期是否正确
- 确认离职日期设置合理
- 查看详细日志了解计算过程

### 日志文件
程序运行时会生成日志文件，位置：
- **程序目录**: `logs/leave_calculator.log`
- **临时目录**: 系统临时文件夹中

## 📋 系统要求

### 最低配置
- **操作系统**: Windows 10+, macOS 10.13+, Ubuntu 18.04+
- **内存**: 512MB 可用内存
- **磁盘空间**: 100MB 可用空间
- **网络**: 能够访问企业微信API

### 推荐配置
- **内存**: 1GB+ 可用内存
- **网络**: 稳定的互联网连接

## 🔒 安全说明

### 数据安全
- 所有企业微信通信使用HTTPS加密
- 配置信息仅存储在本地
- 不会上传或泄露任何企业数据

### 权限要求
- 仅需要企业微信通讯录读取权限
- 不需要其他敏感权限

## 📞 技术支持

### 联系方式
- **开发者**: 斯格拉奇 (Skrachy) 🐔🤖
- **版本**: 1.0.0
- **更新日期**: 2025-01-08

### 获取帮助
1. 查看 `docs/` 目录中的详细文档
2. 检查日志文件中的错误信息
3. 确认配置文件设置正确

## 📄 许可证

本软件仅供内部使用，请勿用于商业用途。

---

**感谢使用离职年假计算器！** 🎉

如有问题，请查看详细文档或联系技术支持。